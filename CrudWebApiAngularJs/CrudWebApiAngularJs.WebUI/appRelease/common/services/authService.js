"use strict";app.factory("authService",["$http","$q","localStorageService","$state","config","$rootScope",function(e,r,s,t,a,u){var o={},n=a.baseUrl,i={isAuth:!1,userEmail:"",userName:"",userRoles:[],userId:""},l=function(e){for(var r=e,s=o.authentication.userRoles,t=[],a=0;a<s.length;++a)for(var u=0;u<r.length;++u)s[a]==r[u]&&t.push(s[a]);return t.length>0},c=function(t){var u=t.userName,t="grant_type=password&username="+u+"&password="+t.password,o=r.defer(),l={method:"POST",url:n+a.authPath,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:t};return e(l).success(function(e){i.isAuth=!0,i.userEmail=e.userEmail,i.userName=e.userName,i.userId=e.userId,i.userRoles=e.roles.split(","),s.set("authorizationData",{token:e.access_token,userEmail:i.userEmail,userName:i.userName,roles:i.userRoles,userId:i.userId,refreshToken:"",useRefreshTokens:!1}),o.resolve(e)}).error(function(e,r){m(),o.reject(e)}),o.promise},h=function(r){var s=r.userName,u=r.password,o={method:"POST",url:n+a.invitationChalengePath,data:r};return e(o).success(function(e){var r={userName:s,password:u};c(r).then(function(e){t.go("workspace.work")},null)}).error(function(e,r){}),deferred.promise},m=function(){s.remove("authorizationData"),i.isAuth=!1,i.userEmail="",i.userName="",i.userId="",u.$emit("logout","logOut")},d=function(){var e=s.get("authorizationData");e&&(i.isAuth=!0,i.userEmail=e.userEmail,i.userName=e.userName,i.userRoles=e.roles,i.userId=e.userId)};d();var f=function(e){var r=!1;for(var s in e)-1!==i.userRoles.indexOf(e[s])&&(r=!0);return r};return o.fillAuthData=d,o.isAuthState=l,o.login=c,o.signUp=h,o.logOut=m,o.authentication=i,o.checkAccess=f,o}]);