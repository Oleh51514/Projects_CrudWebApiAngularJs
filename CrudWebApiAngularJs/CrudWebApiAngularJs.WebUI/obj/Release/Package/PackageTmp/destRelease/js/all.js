var app=angular.module("App",["ui.router","LocalStorageModule","restangular","ui.bootstrap","ngNotify","ngSanitize","ui.select","valdr","department","employee","invitation","home","authorization"]);app.run(["ngNotify","$rootScope","appRoles","authService","$state","localStorageService",function(t,e,a,o,n,i){e.$on("$stateChangeStart",function(t,e,i,u,r){e.data.accessState?e.data.accessRoles[0]!==a.unauthorized&&(o.authentication.isAuth?o.isAuthState(e.data.accessRoles)||t.preventDefault():(t.preventDefault(),n.go("login"))):t.preventDefault()}),t.config({position:"top",duration:3e3,button:!0})}]);

"use strict";app.factory("appUserService",["Restangular",function(e){var t={},r=function(){var t=e.one("AppUsers");return t.userName="username",t.password="password",t},n=function(t){return e.one("AppUsers",t).get()},s=function(){return e.all("AppUsers").getList()},o=function(e){return e.save()},u=function(t){return e.all("AppUsers").customGETLIST("GetPageData",t,{"Content-Type":"application/x-www-form-urlencoded, application/x-www-form-urlencoded"})},a=function(e){return e.remove()},p=function(t){return e.one("AppUsers",userId).one("Projects",t).post()},c=function(t){return e.one("AppUsers",t).all("Projects").getList()},i=function(t){return e.one("AppUsers",t).all("Roles").getList()},l=function(t){return e.one("AppUsers").post("Invite",t)};return t.get=n,t.getAll=s,t.getDefault=r,t.save=o,t["delete"]=a,t.getProjects=c,t.getRoles=i,t.addProject=p,t.getPagedData=u,t.invite=l,t}]);
"use strict";app.factory("authInterceptorService",["$q","$injector","$location","localStorageService",function(t,e,r,a){var o={},n=function(t){t.headers=t.headers||{};var e=a.get("authorizationData");return e&&(t.headers.Authorization="Bearer "+e.token),t},i=function(o){var n=e.get("authService"),i=a.get("authorizationData");return 401===o.status&&void 0===i&&(n.logOut(),r.path("/login")),t.reject(o)};return o.request=n,o.responseError=i,o}]);
"use strict";app.factory("authService",["$http","$q","localStorageService","$state","config","$rootScope",function(e,r,s,t,a,u){var o={},n=a.baseUrl,i={isAuth:!1,userEmail:"",userName:"",userRoles:[],userId:""},l=function(e){for(var r=e,s=o.authentication.userRoles,t=[],a=0;a<s.length;++a)for(var u=0;u<r.length;++u)s[a]==r[u]&&t.push(s[a]);return t.length>0},c=function(t){var u=t.userName,t="grant_type=password&username="+u+"&password="+t.password,o=r.defer(),l={method:"POST",url:n+a.authPath,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:t};return e(l).success(function(e){i.isAuth=!0,i.userEmail=e.userEmail,i.userName=e.userName,i.userId=e.userId,i.userRoles=e.roles.split(","),s.set("authorizationData",{token:e.access_token,userEmail:i.userEmail,userName:i.userName,roles:i.userRoles,userId:i.userId,refreshToken:"",useRefreshTokens:!1}),o.resolve(e)}).error(function(e,r){m(),o.reject(e)}),o.promise},h=function(r){var s=r.userName,u=r.password,o={method:"POST",url:n+a.invitationChalengePath,data:r};return e(o).success(function(e){var r={userName:s,password:u};c(r).then(function(e){t.go("workspace.work")},null)}).error(function(e,r){}),deferred.promise},m=function(){s.remove("authorizationData"),i.isAuth=!1,i.userEmail="",i.userName="",i.userId="",u.$emit("logout","logOut")},d=function(){var e=s.get("authorizationData");e&&(i.isAuth=!0,i.userEmail=e.userEmail,i.userName=e.userName,i.userRoles=e.roles,i.userId=e.userId)};d();var f=function(e){var r=!1;for(var s in e)-1!==i.userRoles.indexOf(e[s])&&(r=!0);return r};return o.fillAuthData=d,o.isAuthState=l,o.login=c,o.signUp=h,o.logOut=m,o.authentication=i,o.checkAccess=f,o}]);
"use strict";app.factory("departmentService",["Restangular","$q",function(e,t){var n={},r=function(){var t=e.one("Departments");return t.name="",t.createdAt=new Date,t},a=function(t){return e.one("Departments",t).get()},o=function(){return e.all("Departments").getList()},u=function(t){return e.all("Departments").customGETLIST("GetPageData",t,{"Content-Type":"application/x-www-form-urlencoded, application/x-www-form-urlencoded"})},c=function(e){return e.save()},i=function(t){return e.one("Departments",t).remove()};return n.getPageData=u,n.getAll=o,n.get=a,n.save=c,n["delete"]=i,n.getDefault=r,n.selectedId=void 0,n}]);
"use strict";app.factory("employeeService",["Restangular","$q",function(e,t){var n={},o=function(){var t=e.one("Employees");return t},r=function(t){return e.one("Employees",t).get()},a=function(){return e.all("Employees").getList()},u=function(t){return e.all("Employees").customGETLIST("GetPageData",t,{"Content-Type":"application/x-www-form-urlencoded, application/x-www-form-urlencoded"})},l=function(e){return e.save()},c=function(t){return e.one("Employees",t).remove()};return n.getPageData=u,n.getAll=a,n.get=r,n.save=l,n["delete"]=c,n.getDefault=o,n}]);
"use strict";app.factory("invitationService",["Restangular",function(t){var n={},e=function(){var n=t.one("Invitations");return n.userEmail="",n.roleName="",n.projectId=0,n},i=function(n){return t.one("Invitations",n).get()},r=function(){return t.all("Invitations").getList()},o=function(t){return t.save()},a=function(n){return t.one("Invitations",n).remove()},u=function(n){return t.all("Invitations").all("Confirm").post(n)};return n.getAll=r,n.get=i,n.save=o,n["delete"]=a,n.confirm=u,n.getDefault=e,n}]);
"use strict";app.factory("roleService",["Restangular",function(e){var t={},n=function(t){return e.one("Roles",t).get()},r=function(){return e.all("Roles").getList()},u=function(e){return e.save()},o=function(e){return e.remove()};return t.get=n,t.getAll=r,t.save=u,t["delete"]=o,t}]);
"use strict";var authorization=angular.module("authorization",["ngAnimate","ui.bootstrap","ui.select","ngSanitize"]);
"use strict";var department=angular.module("department",["ui.grid","ui.grid.pagination","ui.grid.selection","ui.grid.edit","ui.grid.autoResize","ngAnimate","ui.bootstrap","ui.select","ngSanitize"]);
"use strict";var employee=angular.module("employee",["ui.grid","ui.grid.pagination","ui.grid.selection","ui.grid.edit","ui.grid.autoResize","ngAnimate","ui.bootstrap","ui.select","ngSanitize"]);
var home=angular.module("home",[]);
var invitation=angular.module("invitation",["ui.grid","ui.grid.pagination","ngAnimate","ui.bootstrap","ui.select","ngSanitize"]);
"use strict";app.config(["$httpProvider",function(t){t.interceptors.push("authInterceptorService")}]),app.constant("config",{baseUrl:"http://localhost:13869/",authPath:"token",invitationChalengePath:"api/AppUsers/InvitationChalenge"});
app.config(["RestangularProvider",function(t){t.addResponseInterceptor(function(t,e,a,n,o,r){var s;return"getList"===e&&"GetPageData"===a?(s=t.items,s.totalItems=t.totalItems):s=t,s})}]);
"use strict";app.config(["RestangularProvider","config",function(a,e){a.setBaseUrl(e.baseUrl+"api/")}]);
"use strict";app.config(["$stateProvider","$urlRouterProvider","localStorageServiceProvider","appRoles",function(e,t,a,o){a.setPrefix("auth"),t.otherwise("/workspace"),e.state("login",{url:"/login",templateUrl:"app/modules/authorization/views/login.html",controller:"loginController",data:{accessState:!0,accessRoles:[o.unauthorized]}}).state("invitaion",{url:"/invitaion/:token",templateUrl:"app/modules/invitaion/views/invitaion.html",controller:"signUpController",data:{accessState:!0,accessRoles:[o.unauthorized]}}).state("workspace",{url:"/workspace",templateUrl:"app/layouts/workspace.html",controller:"workspaceController",data:{accessState:!0,accessRoles:[o.user,o.manager]}}).state("workspace.home",{url:"/home",templateUrl:"app/modules/home/views/home.html",controller:"homeController",data:{accessState:!0,accessRoles:[o.user,o.manager]}}).state("workspace.inviteUser",{url:"/inviteUser",templateUrl:"app/modules/invitation/views/inviteUser.html",controller:"inviteUserController",data:{accessState:!0,accessRoles:[o.manager]}}).state("workspace.workHub",{url:"/workHub",templateUrl:"app/modules/app/views/workHub.html",controller:"workHubController",data:{accessState:!0,accessRoles:[o.user,o.manager]}}).state("workspace.workHub.work",{url:"/work",views:{department:{templateUrl:"app/modules/department/views/departmentTable.html",controller:"departmentTableController"},employee:{templateUrl:"app/modules/employee/views/employeeTable.html",controller:"employeeTableController"}},data:{accessState:!0,accessRoles:[o.user,o.manager]}})}]);
app.config(["valdrProvider",function(e){e.addConstraints({employee:{firstName:{required:{message:"first name required"}},lastName:{required:{message:"last name required"}},age:{required:{message:"age required"}}},department:{name:{required:{message:"name required"}},description:{required:{message:"description required"}},date:{required:{message:"date required"}}}})}]);
"use strict";app.constant("appRoles",{unauthorized:"Unauthorized",user:"User",manager:"Manager",admin:"Admin",superAdmin:"SuperAdmin"});
"use strict";app.controller("workHubController",["$scope","$rootScope",function(e,t){e.tabs=[{title:"Departments",route:"department",active:!1},{title:"Employees",route:"employee",active:!0}],t.$watch(function(){return e.tabs[1].active},function(e,t){if(1==e);}),e.goToEmployee=function(){e.$broadcast("tabEmployeeEvent",{someProp:"Sending you an Object!"})}}]);
"use strict";app.controller("workspaceController",["$state","authService","$scope","$rootScope",function(t,e,o,a){o.userData={name:e.authentication.userName,email:e.authentication.userEmail},o.$state=t,o.logOut=function(){e.logOut(),t.go("login")}}]);
"use strict";app.controller("loginController",["$scope","authService","$state","$timeout",function(e,o,t,s){o.authentication.isAuth&&t.go("workspace.work"),e.successfully=!1,e.loginData={userName:"",password:""},e.message="",e.login=function(){o.login(e.loginData).then(function(o){e.message="login successfully",e.successfully=!0,a()},function(o){var t=[];for(var s in response.data.modelState)for(var a=0;a<response.data.modelState[s].length;a++)t.push(response.data.modelState[s][a]);e.message="Failed to login user due to:"+t.join(" ")})};var a=function(){var e=s(function(){s.cancel(e),t.go("workspace")},2e3)}}]);
"use strict";app.controller("signUpController",["$scope","$stateParams","authService","invitationService","$state",function(e,s,n,t,a){e.message="",e.appUser={},e.appUser.invitationToken=s.token,e.signUp=function(){t.confirm(e.appUser).then(function(s){n.logOut();var t={userName:e.appUser.userName,password:e.appUser.password};n.login(t).then(function(e){a.go("workspace.workSection.timetrackerTable")},null)},function(s){e.message=s.data,e.successfully=!1})}}]);
"use strict";department.controller("departmentController",["$scope","$uibModalInstance","departmentEntity","departmentService","ngNotify",function(e,t,n,i,o){n.createdAt=new Date(n.createdAt),e.departmentEntity=n,e.open1=function(){e.popup1.opened=!0},e.popup1={opened:!1},e.ok=function(){e.isSaving=!0,n.save(n).then(function(n){o.set(n.description+" updated","success"),e.isSaving=!1,t.close(n)},function(t){o.set(t.message,"error"),e.isSaving=!1})},e.cancel=function(){t.dismiss("cancel")}}]);
"use strict";department.controller("departmentTableController",["$scope","$uibModal","departmentService","ngNotify","$interval",function(e,t,n,i,a){function o(n){var i=t.open({templateUrl:"app/modules/department/views/departmentModal.html",controller:"departmentController",resolve:{departmentEntity:function(){return n}}});i.result.then(function(){e.getPage()},function(){})}e.paginationOptions={skipPageSize:0,takePageSize:5,sortColumns:["id asc"],filters:[]},e.gridOptions={paginationPageSizes:[5,10,15],enableRowSelection:!0,enableRowHeaderSelection:!1,modifierKeysToMultiSelect:!0,noUnselect:!0,multiSelect:!0,paginationPageSize:5,useExternalPagination:!0,useExternalSorting:!0,columnDefs:[{name:"id",visible:!1},{name:"Department Name",field:"name",maxWidth:"300",enableSorting:!1},{name:"Description",field:"description",maxWidth:"120",enableSorting:!1},{name:"Date of creation",field:"createdAt",cellFilter:'date: "dd.MM.yyyy HH:mm"',maxWidth:"185",enableSorting:!1},{name:"action",enableSorting:!1,cellTemplate:'<div class="ui-grid-cell-contents"><button ng-click="grid.appScope.edit(row)">edit</button><button ng-click="grid.appScope.delete(row)">delete</button></div>'}],onRegisterApi:function(t){e.gridApi=t,t.pagination.on.paginationChanged(e,function(t,n){e.paginationOptions.skipPageSize=(t-1)*n,e.paginationOptions.takePageSize=n,e.getPage()}),t.selection.on.rowSelectionChanged(e,function(e){n.selectedId=e.entity.id})}},e.getPage=function(){n.getPageData(e.paginationOptions).then(function(t){e.gridOptions.totalItems=t.totalItems,e.gridOptions.data=t,a(function(){e.gridApi.selection.selectRow(e.gridOptions.data[0])},0,1)},null)},e.getPage(),e["delete"]=function(a){var o=t.open({templateUrl:"app/common/templates/modal/confirmationModal.html"});o.result.then(function(){n["delete"](a.entity.id).then(function(t){i.set("Deleted successed","success");e.gridOptions.data.indexOf(a.entity);e.getPage()},function(e){i.set(e,"error")})},null)},e.edit=function(e){var t=e.entity.clone();o(t)},e.add=function(){var e=n.getDefault();o(e)}}]);
"use strict";employee.controller("employeeController",["$scope","$uibModalInstance","employeeEntity","employeeService","ngNotify","departmentService",function(e,n,t,o,i,c){e.employeeEntity=t,e.employeeEntity.age=parseInt(t.age),e.project={},c.getAll().then(function(n){e.departments=n},null),e.open1=function(){e.popup1.opened=!0},e.popup1={opened:!1},e.ok=function(){e.isSaving=!0,t.save(t).then(function(t){i.set(t.description+" updated","success"),e.isSaving=!1,n.close(t)},function(n){i.set(n.message,"error"),e.isSaving=!1})},e.cancel=function(){n.dismiss("cancel")}}]);
"use strict";employee.controller("employeeTableController",["$scope","$uibModal","employeeService","ngNotify","$interval","departmentService",function(e,t,n,i,a,o){function l(n){var i=t.open({templateUrl:"app/modules/employee/views/employeeModal.html",controller:"employeeController",resolve:{employeeEntity:function(){return n}}});i.result.then(function(){e.getPage()},function(){})}e.$on("tabEmployeeEvent",function(t,n){e.paginationOptions.filters=[],e.paginationOptions.filters.push("DepartmentId =  "+o.selectedId),e.getPage()}),e.paginationOptions={skipPageSize:0,takePageSize:5,sortColumns:["id asc"],filters:[]},e.gridOptions={paginationPageSizes:[5,10,15],enableRowSelection:!0,enableRowHeaderSelection:!1,modifierKeysToMultiSelect:!0,noUnselect:!0,multiSelect:!0,paginationPageSize:5,useExternalPagination:!0,useExternalSorting:!0,columnDefs:[{name:"id",visible:!1},{name:"FirstName",field:"firstName",maxWidth:"300",enableSorting:!1},{name:"LastName",field:"lastName",maxWidth:"120",enableSorting:!1},{name:"Age",field:"age",maxWidth:"70",enableSorting:!1},{name:"Department",field:"department.name",maxWidth:"250"},{name:"action",enableSorting:!1,cellTemplate:'<div class="ui-grid-cell-contents"><button ng-click="grid.appScope.edit(row)">edit</button><button ng-click="grid.appScope.delete(row)">delete</button></div>'}],onRegisterApi:function(t){e.gridApi=t,t.pagination.on.paginationChanged(e,function(t,n){e.paginationOptions.skipPageSize=(t-1)*n,e.paginationOptions.takePageSize=n,e.getPage()})}},e.getPage=function(){n.getPageData(e.paginationOptions).then(function(t){e.gridOptions.totalItems=t.totalItems,e.gridOptions.data=t,a(function(){e.gridApi.selection.selectRow(e.gridOptions.data[0])},0,1)},null)},e["delete"]=function(a){var o=t.open({templateUrl:"app/common/templates/modal/confirmationModal.html"});o.result.then(function(){n["delete"](a.entity.id).then(function(t){i.set("Deleted successed","success");e.gridOptions.data.indexOf(a.entity);e.getPage()},function(e){i.set(e,"error")})},null)},e.edit=function(e){var t=e.entity.clone();l(t)},e.add=function(){var e=n.getDefault();l(e)}}]);
"use strict";home.controller("homeController",["$scope",function(o){}]);
"use strict";invitation.controller("inviteUserController",["$scope","ngNotify","invitationService","roleService",function(i,e,t,n){}]);